# Отчёт по практическому занятию №10
## Выполнил: Лазарев Г.С. 
## Группа: ЭФБО-10-23

## Цели работы
- Подключить Flutter-приложение к локальной базе SQLite через `sqflite`.
- Создать схему таблицы задач и реализовать CRUD: добавление, чтение, обновление, удаление.
- Отделить слой данных (DB helper + модель) от UI.
- Обработать базовые ошибки БД и обеспечить отзывчивый UX (индикатор загрузки, сообщения об ошибках).

## Ход работы
1. **Подготовка проекта**  
   В `pubspec.yaml` добавлены зависимости `sqflite`, `path`, `path_provider`.

2. **Структура проекта**
   - `lib/models.dart`: модель `Task` с полями `id`, `title`, `done`, `createdAt`, методами `fromMap`/`toMap`.
   - `lib/data/db_helper.dart`: открытие `app.db` в каталоге документов, создание таблицы `tasks`, методы `fetchTasks/insertTask/updateTask/deleteTask`.
   - `lib/tasks_page.dart`: экран списка задач, загрузка из SQLite, добавление, отметка выполнения, свайп на удаление, обработка ошибок.
   - `lib/main.dart`: роутинг и экран добавления задачи (возврат текста, сохранение делает `TasksPage`).

3. **Ключевые моменты реализации**
   - Слой данных отделён: UI обращается к `DBHelper`, а модели содержат преобразование к Map для SQLite.
   - Создание таблицы при первом старте: `tasks(id INTEGER PK AUTOINCREMENT, title TEXT NOT NULL, done INTEGER NOT NULL DEFAULT 0, created_at INTEGER NOT NULL)` + индекс по `created_at`.
   - Добавление задачи: FAB открывает экран ввода, после подтверждения создаётся запись в БД и добавляется в список.
   - Обновление: чекбокс переключает `done`, изменение сохраняется в БД.
   - Удаление: свайп по элементу или иконка удаляет строку из БД, SnackBar подтверждает успех.
   - Состояния: индикатор загрузки при старте, текст при пустом списке, SnackBar для ошибок.

4. **Контрольные скриншоты**
   - Пустой список после первого запуска.
   - Добавленная задача в списке.
   - Переключение статуса/удаление (свайп и SnackBar).

5. **Ошибки и их решения**
   - `no such table: tasks`: увеличить версию схемы в `DBHelper` при изменениях или переустановить приложение.
   - Блокировки: не держать долгих операций на UI-потоке, все вызовы `await`.
<img width="468" height="922" alt="2025-11-27_22-28-53" src="https://github.com/user-attachments/assets/965a368c-0395-4e06-868e-3c18625306b2" /><img width="395" height="858" alt="2025-11-27_22-29-06" src="https://github.com/user-attachments/assets/3f64d6fb-455b-414a-b1bd-765c9ca29d96" />

<img width="425" height="911" alt="2025-11-27_22-29-19" src="https://github.com/user-attachments/assets/e6f42fcf-bb95-4ce0-b0c9-b9ab5e7e1ff1" />
<img width="1205" height="826" alt="image" src="https://github.com/user-attachments/assets/696e70c4-4524-4216-af4c-90b719a097bf" />


